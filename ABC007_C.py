import io
import sys

_INPUT = """\
6
7 8
2 2
4 5
########
#......#
#.######
#..#...#
#..##..#
##.....#
########
5 8
2 2
2 4
########
#.#....#
#.###..#
#......#
########
50 50
2 2
49 49
##################################################
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
#................................................#
##################################################
"""

sys.stdin = io.StringIO(_INPUT)
case_no=int(input())
for __ in range(case_no):
  #BFS
  from collections import deque
  def bfs(G,s):
    inf=10**30
    D=[inf]*len(G)
    D[s]=0
    dq=deque()
    dq.append(s)
    while dq:
      x=dq.popleft()
      for y in G[x]:
        if D[y]>D[x]+1:
          D[y]=D[x]+1
          dq.append(y)
    return D
  R,C=map(int,input().split())
  sy,sx=map(int,input().split())
  gy,gx=map(int,input().split())
  c=[input() for _ in range(R)]
  G=[[] for _ in range(R*C)]
  for i in range(R):
    for j in range(C):
      if c[i][j]=='#': continue
      for k,l in [[i-1,j],[i,j-1],[i+1,j],[i,j+1]]:
        if 0<=k<R and 0<=l<C and c[k][l]=='.': G[i*C+j].append(k*C+l)
  print(bfs(G,(sy-1)*C+sx-1)[(gy-1)*C+gx-1])